#!/bin/bash
# MCP JQ Client Wrapper Script

SERVER_URL="http://10.159.47.21:8001/sse"

mcp_call() {
    local method="$1"
    local id="${2:-1}"

    echo "ğŸ”§ Calling method: $method (using jq server)"

    # jqë¡œ ìš”ì²­ JSON ìƒì„±
    request=$(jq -n --arg method "$method" --argjson id "$id" '{
        jsonrpc: "2.0",
        id: $id,
        method: $method
    }')

    echo "ğŸ“¤ Request: $request"

    # ì„œë²„ì— ìš”ì²­ ì „ì†¡
    response=$(curl -s -X POST "$SERVER_URL" \
        -H "Content-Type: application/json" \
        -d "$request")

    echo "ğŸ“¥ Response:"
    echo "$response" | jq .
    echo ""
}

# ì‚¬ìš©ë²• ì¶œë ¥
if [ $# -eq 0 ]; then
    echo "Usage: $0 <method> [id]"
    echo "Available methods: initialize, hello, bye, shutdown"
    echo "Examples:"
    echo "  $0 initialize"
    echo "  $0 hello 2"
    echo "  $0 bye 3"
    exit 1
fi

mcp_call "$@"