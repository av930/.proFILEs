#!/bin/bash
# MCP JQ Client Wrapper Script

SERVER_URL="http://10.159.47.21:8001/sse"

mcp_call() {
    local method="$1"
    local id="${2:-1}"

    echo "🔧 Calling method: $method (using jq server)"

    # jq로 요청 JSON 생성
    request=$(jq -n --arg method "$method" --argjson id "$id" '{
        jsonrpc: "2.0",
        id: $id,
        method: $method
    }')

    echo "📤 Request: $request"

    # 서버에 요청 전송
    response=$(curl -s -X POST "$SERVER_URL" \
        -H "Content-Type: application/json" \
        -d "$request")

    echo "📥 Response:"
    echo "$response" | jq .
    echo ""
}

# 사용법 출력
if [ $# -eq 0 ]; then
    echo "Usage: $0 <method> [id]"
    echo "Available methods: initialize, hello, bye, shutdown"
    echo "Examples:"
    echo "  $0 initialize"
    echo "  $0 hello 2"
    echo "  $0 bye 3"
    exit 1
fi

mcp_call "$@"